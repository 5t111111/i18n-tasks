<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>i18n-tasks by glebm</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">i18n-tasks</h1>
      <h2 class="project-tagline">Manage translation and localization with static analysis, for Ruby i18n</h2>
      <a href="https://github.com/glebm/i18n-tasks" class="btn">View on GitHub</a>
      <a href="https://github.com/glebm/i18n-tasks/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/glebm/i18n-tasks/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="i18n-tasks-----" class="anchor" href="#i18n-tasks-----" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>i18n-tasks <a href="https://travis-ci.org/glebm/i18n-tasks"><img src="http://img.shields.io/travis/glebm/i18n-tasks.svg" alt="Build Status"></a> <a href="https://codeclimate.com/github/glebm/i18n-tasks"><img src="https://img.shields.io/codeclimate/coverage/github/glebm/i18n-tasks.svg" alt="Coverage Status"></a> <a href="https://codeclimate.com/github/glebm/i18n-tasks"><img src="http://img.shields.io/codeclimate/github/glebm/i18n-tasks.svg" alt="Code Climate"></a> <a href="https://gemnasium.com/glebm/i18n-tasks"><img src="https://gemnasium.com/glebm/i18n-tasks.svg" alt="Gemnasium"></a> <a href="https://gitter.im/glebm/i18n-tasks?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge"><img src="https://badges.gitter.im/Join%20Chat.svg" alt="Gitter"></a>
</h1>

<p><a href="https://pledgie.com/campaigns/28570"><img alt="Click here to lend your support to: i18n-tasks for Ruby and make a donation at pledgie.com !" src="https://pledgie.com/campaigns/28570.png?skin_name=chrome" border="0"></a></p>

<p>i18n-tasks helps you find and manage missing and unused translations.</p>

<p><img width="539" height="331" src="https://i.imgur.com/XZBd8l7.png"></p>

<p>This gem analyses code statically for key usages, such as <code>I18n.t('some.key')</code>, in order to:</p>

<ul>
<li>Report keys that are missing or unused.</li>
<li>Pre-fill missing keys, optionally from Google Translate.</li>
<li>Remove unused keys.</li>
</ul>

<p>Thus addressing the two main problems of <a href="https://github.com/svenfuchs/i18n" title="svenfuchs/i18n on Github">i18n gem</a> design:</p>

<ul>
<li>Missing keys only blow up at runtime.</li>
<li>Keys no longer in use may accumulate and introduce overhead, without you knowing it.</li>
</ul>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h2>

<p>i18n-tasks can be used with any project using the ruby <a href="https://github.com/svenfuchs/i18n" title="svenfuchs/i18n on Github">i18n gem</a> (default in Rails).</p>

<p>Add i18n-tasks to the Gemfile:</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-k">gem</span> <span class="pl-s"><span class="pl-pds">'</span>i18n-tasks<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>~&gt; 0.9.4<span class="pl-pds">'</span></span></pre></div>

<p>Copy the default <a href="#configuration">configuration file</a>:</p>

<div class="highlight highlight-text-shell-session"><pre>$ <span class="pl-s1">cp <span class="pl-s"><span class="pl-pds">$(</span>i18n-tasks gem-path<span class="pl-pds">)</span></span>/templates/config/i18n-tasks.yml config/</span></pre></div>

<p>Copy rspec test to test for missing and unused translations as part of the suite (optional):</p>

<div class="highlight highlight-text-shell-session"><pre>$ <span class="pl-s1">cp <span class="pl-s"><span class="pl-pds">$(</span>i18n-tasks gem-path<span class="pl-pds">)</span></span>/templates/rspec/i18n_spec.rb spec/</span></pre></div>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Usage</h2>

<p>Run <code>i18n-tasks</code> to get the list of all the tasks with short descriptions.</p>

<h3>
<a id="check-health" class="anchor" href="#check-health" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Check health</h3>

<p><code>i18n-tasks health</code> checks if any keys are missing or not used:</p>

<div class="highlight highlight-text-shell-session"><pre>$ <span class="pl-s1">i18n-tasks health</span></pre></div>

<h3>
<a id="add-missing-keys" class="anchor" href="#add-missing-keys" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Add missing keys</h3>

<p>Add missing keys with placeholders (base value or humanized key):</p>

<div class="highlight highlight-text-shell-session"><pre>$ <span class="pl-s1">i18n-tasks add-missing</span></pre></div>

<p>This and other tasks accept arguments:</p>

<div class="highlight highlight-text-shell-session"><pre>$ <span class="pl-s1">i18n-tasks add-missing -v <span class="pl-s"><span class="pl-pds">'</span>TRME %{value}<span class="pl-pds">'</span></span> fr</span></pre></div>

<p>Pass <code>--help</code> for more information:</p>

<div class="highlight highlight-text-shell-session"><pre>$ <span class="pl-s1">i18n-tasks add-missing --help</span>
<span class="pl-mo">Usage: i18n-tasks add-missing [options] [locale ...]</span>
<span class="pl-mo">    -l, --locales  Comma-separated list of locale(s) to process. Default: all. Special: base.</span>
<span class="pl-mo">    -f, --format   Output format: terminal-table, yaml, json, keys, inspect. Default: terminal-table.</span>
<span class="pl-mo">    -v, --value    Value. Interpolates: %{value}, %{human_key}, %{value_or_human_key}, %{key}. Default: %{value_or_human_key}.</span>
<span class="pl-mo">    -h, --help     Display this help message.</span></pre></div>

<h3>
<a id="google-translate-missing-keys" class="anchor" href="#google-translate-missing-keys" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Google Translate missing keys</h3>

<p>Translate missing values with Google Translate (<a href="#translation-config">more below on the API key</a>).</p>

<div class="highlight highlight-text-shell-session"><pre>$ <span class="pl-s1">i18n-tasks translate-missing</span>
# <span class="pl-s1">accepts from and locales options:</span>
$ <span class="pl-s1">i18n-tasks translate-missing --from base es fr</span></pre></div>

<h3>
<a id="find-usages" class="anchor" href="#find-usages" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Find usages</h3>

<p>See where the keys are used with <code>i18n-tasks find</code>:</p>

<div class="highlight highlight-source-shell"><pre>$ i18n-tasks find common.<span class="pl-c1">help</span>
$ i18n-tasks find <span class="pl-s"><span class="pl-pds">'</span>auth.*<span class="pl-pds">'</span></span>
$ i18n-tasks find <span class="pl-s"><span class="pl-pds">'</span>{number,currency}.format.*<span class="pl-pds">'</span></span></pre></div>

<p><img width="437" height="129" src="https://i.imgur.com/VxBrSfY.png"></p>

<h3>
<a id="remove-unused-keys" class="anchor" href="#remove-unused-keys" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Remove unused keys</h3>

<div class="highlight highlight-source-shell"><pre>$ i18n-tasks unused
$ i18n-tasks remove-unused</pre></div>

<p>These tasks can infer <a href="#dynamic-keys">dynamic keys</a> such as <code>t("category.\#{category.name}")</code> if you set
<code>search.strict</code> to false, or pass <code>--no-strict</code> on the command line.</p>

<h3>
<a id="normalize-data" class="anchor" href="#normalize-data" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Normalize data</h3>

<p>Sort the keys:</p>

<div class="highlight highlight-text-shell-session"><pre>$ <span class="pl-s1">i18n-tasks normalize</span></pre></div>

<p>Sort the keys, and move them to the respective files as defined by <a href="#multiple-locale-files"><code>config.write</code></a>:</p>

<div class="highlight highlight-text-shell-session"><pre>$ <span class="pl-s1">i18n-tasks normalize -p</span></pre></div>

<h3>
<a id="compose-tasks" class="anchor" href="#compose-tasks" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Compose tasks</h3>

<p><code>i18n-tasks</code> also provides composable tasks for reading, writing and manipulating locale data. Examples below.</p>

<p><code>add-missing</code> implemented with <code>missing</code>, <code>tree-set-value</code> and <code>data-merge</code>:</p>

<div class="highlight highlight-text-shell-session"><pre>$ <span class="pl-s1">i18n-tasks missing -f yaml fr <span class="pl-k">|</span> i18n-tasks tree-set-value <span class="pl-s"><span class="pl-pds">'</span>TRME %{value}<span class="pl-pds">'</span></span> <span class="pl-k">|</span> i18n-tasks data-merge</span></pre></div>

<p><code>remove-unused</code> implemented with <code>unused</code> and <code>data-remove</code> (sans the confirmation):</p>

<div class="highlight highlight-text-shell-session"><pre>$ <span class="pl-s1">i18n-tasks unused -f yaml <span class="pl-k">|</span> i18n-tasks data-remove</span></pre></div>

<p>Remove all keys in <code>fr</code> but not <code>en</code> from <code>fr</code>:</p>

<div class="highlight highlight-text-shell-session"><pre>$ <span class="pl-s1">i18n-tasks missing -t diff -f yaml en <span class="pl-k">|</span> i18n-tasks tree-rename-key en fr <span class="pl-k">|</span> i18n-tasks data-remove</span></pre></div>

<p>See the full list of tasks with <code>i18n-tasks --help</code>.</p>

<h3>
<a id="features-and-limitations" class="anchor" href="#features-and-limitations" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Features and limitations</h3>

<p><code>i18n-tasks</code> uses an AST scanner for <code>.rb</code> files, and a regexp-based scanner for other files, such as <code>.haml</code>.</p>

<h4>
<a id="relative-keys" class="anchor" href="#relative-keys" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Relative keys</h4>

<p><code>i18n-tasks</code> offers support for relative keys, such as <code>t '.title'</code>.</p>

<p>✔ Keys relative to the file path they are used in (see <a href="#usage-search">relative roots configuration</a>) are supported.</p>

<p>✔ Keys relative to <code>controller.action_name</code> in Rails controllers are supported. The closest <code>def</code> name is used.</p>

<h4>
<a id="plural-keys" class="anchor" href="#plural-keys" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Plural keys</h4>

<p>✔ Plural keys, such as <code>key.{one,many,other,...}</code> are fully supported.</p>

<h4>
<a id="reference-keys" class="anchor" href="#reference-keys" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Reference keys</h4>

<p>✔ Reference keys (keys with <code>:symbol</code> values) are fully supported. These keys are copied as-is in
<code>add/translate-missing</code>, and can be looked up by reference or value in <code>find</code>.</p>

<h4>
<a id="t-keyword-arguments" class="anchor" href="#t-keyword-arguments" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>t()</code> keyword arguments</h4>

<p>✔ <code>scope</code> keyword argument is fully supported by the AST scanner, and also by the Regexp scanner but only when it is the first argument.</p>

<p>✔ <code>default</code> argument can be used to pre-fill locale files (AST scanner only).</p>

<h4>
<a id="dynamic-keys" class="anchor" href="#dynamic-keys" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Dynamic keys</h4>

<p>By default, dynamic keys such as <code>t "cats.#{cat}.name"</code> are not recognized.
I encourage you to mark these with <a href="#fine-tuning">i18n-tasks-use hints</a>.</p>

<p>Alternatively, you can enable dynamic key inference by setting <code>search.strict</code> to <code>false</code> in the config. In this case,
all the dynamic parts of the key will be considered used, e.g. <code>cats.tenderlove.name</code> would not be reported as unused.
Note that only one section of the key is treated as a wildcard for each string interpolation; i.e. in this example,
<code>cats.tenderlove.special.name</code> <em>will</em> be reported as unused.</p>

<h2>
<a id="configuration" class="anchor" href="#configuration" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Configuration</h2>

<p>Configuration is read from <code>config/i18n-tasks.yml</code> or <code>config/i18n-tasks.yml.erb</code>.
Inspect the configuration with <code>i18n-tasks config</code>.</p>

<p>Install the <a href="https://github.com/glebm/i18n-tasks/blob/master/templates/config/i18n-tasks.yml">default config file</a> with:</p>

<div class="highlight highlight-text-shell-session"><pre>$ <span class="pl-s1">cp <span class="pl-s"><span class="pl-pds">$(</span>i18n-tasks gem-path<span class="pl-pds">)</span></span>/templates/config/i18n-tasks.yml config/</span></pre></div>

<p>Settings are compatible with Rails by default.</p>

<h3>
<a id="locales" class="anchor" href="#locales" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Locales</h3>

<p>By default, <code>base_locale</code> is set to <code>en</code> and <code>locales</code> are inferred from the paths to data files.
You can override these in the <a href="https://github.com/glebm/i18n-tasks/blob/master/templates/config/i18n-tasks.yml">config</a>.</p>

<h3>
<a id="storage" class="anchor" href="#storage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Storage</h3>

<p>The default data adapter supports YAML and JSON files.</p>

<h4>
<a id="multiple-locale-files" class="anchor" href="#multiple-locale-files" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Multiple locale files</h4>

<p>i18n-tasks can manage multiple translation files and read translations from other gems.
To find out more see the <code>data</code> options in the <a href="https://github.com/glebm/i18n-tasks/blob/master/templates/config/i18n-tasks.yml">config</a>.
NB: By default, only <code>%{locale}.yml</code> files are read, not <code>namespace.%{locale}.yml</code>. Make sure to check the config.</p>

<p>For writing to locale files i18n-tasks provides 2 options.</p>

<h5>
<a id="pattern-router" class="anchor" href="#pattern-router" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Pattern router</h5>

<p>Pattern router organizes keys based on a list of key patterns, as in the example below:</p>

<pre><code>data:
  router: pattern_router
  # a list of {key pattern =&gt; file} routes, matched top to bottom
  write:
    # write models.* and views.* keys to the respective files
    - ['{models,views}.*', 'config/locales/\1.%{locale}.yml']
    # or, write every top-level key namespace to its own file
    - ['{:}.*', 'config/locales/\1.%{locale}.yml']
    # default, sugar for ['*', path]
    - 'config/locales/%{locale}.yml'
</code></pre>

<h5>
<a id="conservative-router" class="anchor" href="#conservative-router" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Conservative router</h5>

<p>Conservative router keeps the keys where they are found, or infers the path from base locale.
If the key is completely new, conservative router will fall back to pattern router behaviour.
Conservative router is the <strong>default</strong> router.</p>

<pre><code>data:
  router: conservative_router
  write:
    - ['devise.*', 'config/locales/devise.%{locale}.yml']
    - 'config/locales/%{locale}.yml'
</code></pre>

<p>If you want to have i18n-tasks reorganize your existing keys using <code>data.write</code>, either set the router to 
<code>pattern_router</code> as above, or run <code>i18n-tasks normalize -p</code> (forcing the use of the pattern router for that run).</p>

<h5>
<a id="key-pattern-syntax" class="anchor" href="#key-pattern-syntax" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Key pattern syntax</h5>

<p>A special syntax similar to file glob patterns is used throughout i18n-tasks to match translation keys:</p>

<table>
<thead>
<tr>
<th align="center">syntax</th>
<th align="left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>*</code></td>
<td align="left">matches everything</td>
</tr>
<tr>
<td align="center"><code>:</code></td>
<td align="left">matches a single key</td>
</tr>
<tr>
<td align="center"><code>{a, b.c}</code></td>
<td align="left">match any in set, can use <code>:</code> and <code>*</code>, match is captured</td>
</tr>
</tbody>
</table>

<h4>
<a id="custom-adapters" class="anchor" href="#custom-adapters" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Custom adapters</h4>

<p>If you store data somewhere but in the filesystem, e.g. in the database or mongodb, you can implement a custom adapter.
If you have implemented a custom adapter please share it on <a href="https://github.com/glebm/i18n-tasks/wiki" title="i18n-tasks wiki">the wiki</a>.</p>

<h3>
<a id="usage-search" class="anchor" href="#usage-search" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Usage search</h3>

<p>i18n-tasks uses an AST scanner for <code>.rb</code> files, and a regexp scanner for all other files.
New scanners can be added easily: please refer to <a href="https://github.com/glebm/i18n-tasks/wiki/A-custom-scanner-example">this example</a>.</p>

<p>See the <code>search</code> section in the <a href="https://github.com/glebm/i18n-tasks/blob/master/templates/config/i18n-tasks.yml">config file</a> for all available configuration options.
NB: By default, only the <code>app/</code> directory is searched.</p>

<h3>
<a id="fine-tuning" class="anchor" href="#fine-tuning" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Fine-tuning</h3>

<p>Add hints to static analysis with magic comment hints (lines starting with <code>(#|/) i18n-tasks-use</code> by default):</p>

<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># i18n-tasks-use t('activerecord.models.user') # let i18n-tasks know the key is used</span>
<span class="pl-c1">User</span>.model_name.human</pre></div>

<p>You can also explicitly ignore keys appearing in locale files via <code>ignore*</code> settings.
See the <a href="https://github.com/glebm/i18n-tasks/blob/master/templates/config/i18n-tasks.yml">config file</a> to find out more.</p>

<p><a name="translation-config"></a></p>

<h3>
<a id="google-translate" class="anchor" href="#google-translate" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Google Translate</h3>

<p><code>i18n-tasks translate-missing</code> requires a Google Translate API key, get it at <a href="https://code.google.com/apis/console">Google API Console</a>.</p>

<p>Where this key is depends on your Google API console:</p>

<ul>
<li>Old console: API Access -&gt; Simple API Access -&gt; Key for server apps.</li>
<li>New console: Project -&gt; APIS &amp; AUTH -&gt; Credentials -&gt; Public API access -&gt; Key for server applications.</li>
</ul>

<p>In both cases, you may need to create the key if it doesn't exist.</p>

<p>Put the key in <code>GOOGLE_TRANSLATE_API_KEY</code> environment variable or in the config file.</p>

<div class="highlight highlight-source-yaml"><pre><span class="pl-c"># config/i18n-tasks.yml</span>
<span class="pl-s"><span class="pl-ent">translation:</span></span>
  <span class="pl-s"><span class="pl-ent">api_key:</span> <span class="pl-s">&lt;Google Translate API key&gt;</span></span></pre></div>

<h2>
<a id="interactive-console" class="anchor" href="#interactive-console" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Interactive console</h2>

<p><code>i18n-tasks irb</code> starts an IRB session in i18n-tasks context. Type <code>guide</code> for more information.</p>

<h3>
<a id="xlsx" class="anchor" href="#xlsx" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>XLSX</h3>

<p>Export missing and unused data to XLSX:</p>

<div class="highlight highlight-text-shell-session"><pre>$ <span class="pl-s1">i18n-tasks xlsx-report</span></pre></div>

<h2>
<a id="add-new-tasks" class="anchor" href="#add-new-tasks" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Add new tasks</h2>

<p>Tasks that come with the gem are defined in <a href="lib/i18n/tasks/command/commands">lib/i18n/tasks/command/commands</a>.
Custom tasks can be added easily, see the examples <a href="https://github.com/glebm/i18n-tasks/wiki#custom-tasks">on the wiki</a>.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/glebm/i18n-tasks">i18n-tasks</a> is maintained by <a href="https://github.com/glebm">glebm</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-65961090-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
