{"name":"i18n-tasks","tagline":"Manage translation and localization with static analysis, for Ruby i18n","body":"# i18n-tasks [![Build Status][badge-travis]][travis] [![Coverage Status][badge-coverage]][coverage] [![Code Climate][badge-code-climate]][code-climate] [![Gemnasium][badge-gemnasium]][gemnasium] [![Gitter](https://badges.gitter.im/Join Chat.svg)](https://gitter.im/glebm/i18n-tasks?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=badge)\r\n\r\n<a href='https://pledgie.com/campaigns/28570'><img alt='Click here to lend your support to: i18n-tasks for Ruby and make a donation at pledgie.com !' src='https://pledgie.com/campaigns/28570.png?skin_name=chrome' border='0' ></a>\r\n\r\ni18n-tasks helps you find and manage missing and unused translations.\r\n\r\n<img width=\"539\" height=\"331\" src=\"https://i.imgur.com/XZBd8l7.png\">\r\n\r\nThis gem analyses code statically for key usages, such as `I18n.t('some.key')`, in order to:\r\n\r\n* Report keys that are missing or unused.\r\n* Pre-fill missing keys, optionally from Google Translate.\r\n* Remove unused keys.\r\n\r\nThus addressing the two main problems of [i18n gem][i18n-gem] design:\r\n\r\n* Missing keys only blow up at runtime.\r\n* Keys no longer in use may accumulate and introduce overhead, without you knowing it.\r\n\r\n## Installation\r\n\r\ni18n-tasks can be used with any project using the ruby [i18n gem][i18n-gem] (default in Rails).\r\n\r\nAdd i18n-tasks to the Gemfile:\r\n\r\n```ruby\r\ngem 'i18n-tasks', '~> 0.9.5'\r\n```\r\n\r\nCopy the default [configuration file](#configuration):\r\n\r\n```console\r\n$ cp $(i18n-tasks gem-path)/templates/config/i18n-tasks.yml config/\r\n```\r\n\r\nCopy rspec test to test for missing and unused translations as part of the suite (optional):\r\n\r\n```console\r\n$ cp $(i18n-tasks gem-path)/templates/rspec/i18n_spec.rb spec/\r\n```\r\n\r\n## Usage\r\n\r\nRun `i18n-tasks` to get the list of all the tasks with short descriptions.\r\n\r\n### Check health\r\n\r\n`i18n-tasks health` checks if any keys are missing or not used:\r\n\r\n```console\r\n$ i18n-tasks health\r\n```\r\n\r\n### Add missing keys\r\n\r\nAdd missing keys with placeholders (base value or humanized key):\r\n\r\n```console\r\n$ i18n-tasks add-missing\r\n```\r\n\r\nThis and other tasks accept arguments:\r\n\r\n```console\r\n$ i18n-tasks add-missing -v 'TRME %{value}' fr\r\n```\r\n\r\nPass `--help` for more information:\r\n\r\n```console\r\n$ i18n-tasks add-missing --help\r\nUsage: i18n-tasks add-missing [options] [locale ...]\r\n    -l, --locales  Comma-separated list of locale(s) to process. Default: all. Special: base.\r\n    -f, --format   Output format: terminal-table, yaml, json, keys, inspect. Default: terminal-table.\r\n    -v, --value    Value. Interpolates: %{value}, %{human_key}, %{value_or_human_key}, %{key}. Default: %{value_or_human_key}.\r\n    -h, --help     Display this help message.\r\n```\r\n\r\n### Google Translate missing keys\r\n\r\nTranslate missing values with Google Translate ([more below on the API key](#translation-config)).\r\n\r\n```console\r\n$ i18n-tasks translate-missing\r\n# accepts from and locales options:\r\n$ i18n-tasks translate-missing --from base es fr\r\n```\r\n\r\n### Find usages\r\n\r\nSee where the keys are used with `i18n-tasks find`:\r\n\r\n```bash\r\n$ i18n-tasks find common.help\r\n$ i18n-tasks find 'auth.*'\r\n$ i18n-tasks find '{number,currency}.format.*'\r\n```\r\n\r\n<img width=\"437\" height=\"129\" src=\"https://i.imgur.com/VxBrSfY.png\">\r\n\r\n### Remove unused keys\r\n\r\n```bash\r\n$ i18n-tasks unused\r\n$ i18n-tasks remove-unused\r\n```\r\n\r\nThese tasks can infer [dynamic keys](#dynamic-keys) such as `t(\"category.\\#{category.name}\")` if you set\r\n`search.strict` to false, or pass `--no-strict` on the command line.\r\n\r\n### Normalize data\r\n\r\nSort the keys:\r\n\r\n```console\r\n$ i18n-tasks normalize\r\n```\r\n\r\nSort the keys, and move them to the respective files as defined by [`config.write`](#multiple-locale-files):\r\n\r\n```console\r\n$ i18n-tasks normalize -p\r\n```\r\n\r\n### Compose tasks\r\n\r\n`i18n-tasks` also provides composable tasks for reading, writing and manipulating locale data. Examples below.\r\n\r\n`add-missing` implemented with `missing`, `tree-set-value` and `data-merge`:\r\n```console\r\n$ i18n-tasks missing -f yaml fr | i18n-tasks tree-set-value 'TRME %{value}' | i18n-tasks data-merge\r\n```\r\n\r\n`remove-unused` implemented with `unused` and `data-remove` (sans the confirmation):\r\n```console\r\n$ i18n-tasks unused -f yaml | i18n-tasks data-remove\r\n```\r\n\r\nRemove all keys in `fr` but not `en` from `fr`:\r\n```console\r\n$ i18n-tasks missing -t diff -f yaml en | i18n-tasks tree-rename-key en fr | i18n-tasks data-remove\r\n```\r\n\r\nSee the full list of tasks with `i18n-tasks --help`.\r\n\r\n### Features and limitations\r\n\r\n`i18n-tasks` uses an AST scanner for `.rb` files, and a regexp-based scanner for other files, such as `.haml`.\r\n\r\n#### Relative keys\r\n\r\n`i18n-tasks` offers support for relative keys, such as `t '.title'`.\r\n\r\n✔ Keys relative to the file path they are used in (see [relative roots configuration](#usage-search)) are supported.\r\n\r\n✔ Keys relative to `controller.action_name` in Rails controllers are supported. The closest `def` name is used.\r\n\r\n#### Plural keys\r\n\r\n✔ Plural keys, such as `key.{one,many,other,...}` are fully supported.\r\n\r\n#### Reference keys\r\n\r\n✔ Reference keys (keys with `:symbol` values) are fully supported. These keys are copied as-is in\r\n`add/translate-missing`, and can be looked up by reference or value in `find`.\r\n\r\n#### `t()` keyword arguments\r\n\r\n✔ `scope` keyword argument is fully supported by the AST scanner, and also by the Regexp scanner but only when it is the first argument.\r\n\r\n✔ `default` argument can be used to pre-fill locale files (AST scanner only).\r\n\r\n#### Dynamic keys\r\n\r\nBy default, dynamic keys such as `t \"cats.#{cat}.name\"` are not recognized.\r\nI encourage you to mark these with [i18n-tasks-use hints](#fine-tuning).\r\n\r\nAlternatively, you can enable dynamic key inference by setting `search.strict` to `false` in the config. In this case,\r\nall the dynamic parts of the key will be considered used, e.g. `cats.tenderlove.name` would not be reported as unused.\r\nNote that only one section of the key is treated as a wildcard for each string interpolation; i.e. in this example,\r\n`cats.tenderlove.special.name` *will* be reported as unused.\r\n\r\n## Configuration\r\n\r\nConfiguration is read from `config/i18n-tasks.yml` or `config/i18n-tasks.yml.erb`.\r\nInspect the configuration with `i18n-tasks config`.\r\n\r\nInstall the [default config file][config] with:\r\n\r\n```console\r\n$ cp $(i18n-tasks gem-path)/templates/config/i18n-tasks.yml config/\r\n```\r\n\r\nSettings are compatible with Rails by default.\r\n\r\n### Locales\r\n\r\nBy default, `base_locale` is set to `en` and `locales` are inferred from the paths to data files.\r\nYou can override these in the [config][config].\r\n\r\n### Storage\r\n\r\nThe default data adapter supports YAML and JSON files.\r\n\r\n#### Multiple locale files\r\n\r\ni18n-tasks can manage multiple translation files and read translations from other gems.\r\nTo find out more see the `data` options in the [config][config].\r\nNB: By default, only `%{locale}.yml` files are read, not `namespace.%{locale}.yml`. Make sure to check the config.\r\n\r\nFor writing to locale files i18n-tasks provides 2 options.\r\n\r\n##### Pattern router\r\n\r\nPattern router organizes keys based on a list of key patterns, as in the example below:\r\n\r\n```\r\ndata:\r\n  router: pattern_router\r\n  # a list of {key pattern => file} routes, matched top to bottom\r\n  write:\r\n    # write models.* and views.* keys to the respective files\r\n    - ['{models,views}.*', 'config/locales/\\1.%{locale}.yml']\r\n    # or, write every top-level key namespace to its own file\r\n    - ['{:}.*', 'config/locales/\\1.%{locale}.yml']\r\n    # default, sugar for ['*', path]\r\n    - 'config/locales/%{locale}.yml'\r\n```\r\n\r\n##### Conservative router\r\n\r\nConservative router keeps the keys where they are found, or infers the path from base locale.\r\nIf the key is completely new, conservative router will fall back to pattern router behaviour.\r\nConservative router is the **default** router.\r\n\r\n```\r\ndata:\r\n  router: conservative_router\r\n  write:\r\n    - ['devise.*', 'config/locales/devise.%{locale}.yml']\r\n    - 'config/locales/%{locale}.yml'\r\n```\r\n\r\nIf you want to have i18n-tasks reorganize your existing keys using `data.write`, either set the router to \r\n`pattern_router` as above, or run `i18n-tasks normalize -p` (forcing the use of the pattern router for that run).\r\n\r\n##### Key pattern syntax\r\n\r\nA special syntax similar to file glob patterns is used throughout i18n-tasks to match translation keys:\r\n\r\n| syntax       | description                                               |\r\n|:------------:|:----------------------------------------------------------|\r\n|      `*`     | matches everything                                        |\r\n|      `:`     | matches a single key                                      |\r\n|   `{a, b.c}` | match any in set, can use `:` and `*`, match is captured  |\r\n\r\n\r\n#### Custom adapters\r\n\r\nIf you store data somewhere but in the filesystem, e.g. in the database or mongodb, you can implement a custom adapter.\r\nIf you have implemented a custom adapter please share it on [the wiki][wiki].\r\n\r\n### Usage search\r\n\r\ni18n-tasks uses an AST scanner for `.rb` files, and a regexp scanner for all other files.\r\nNew scanners can be added easily: please refer to [this example](https://github.com/glebm/i18n-tasks/wiki/A-custom-scanner-example).\r\n\r\nSee the `search` section in the [config file][config] for all available configuration options.\r\nNB: By default, only the `app/` directory is searched.\r\n\r\n### Fine-tuning\r\n\r\nAdd hints to static analysis with magic comment hints (lines starting with `(#|/) i18n-tasks-use` by default):\r\n\r\n```ruby\r\n# i18n-tasks-use t('activerecord.models.user') # let i18n-tasks know the key is used\r\nUser.model_name.human\r\n```\r\n\r\nYou can also explicitly ignore keys appearing in locale files via `ignore*` settings.\r\n\r\nIf you have helper methods that generate translation keys, such as a `page_title` method that returns `t '.page_title'`,\r\nor a `Spree.t(key)` method that returns `t \"spree.#{key}\"`, use the built-in `PatternMapper` to map these.\r\n\r\nFor more complex cases, you can implement a [custom scanner][custom-scanner-docs].\r\n\r\nSee the [config file][config] to find out more.\r\n\r\n<a name=\"translation-config\"></a>\r\n### Google Translate\r\n\r\n`i18n-tasks translate-missing` requires a Google Translate API key, get it at [Google API Console](https://code.google.com/apis/console).\r\n\r\nWhere this key is depends on your Google API console:\r\n\r\n* Old console: API Access -> Simple API Access -> Key for server apps.\r\n* New console: Project -> APIS & AUTH -> Credentials -> Public API access -> Key for server applications.\r\n\r\nIn both cases, you may need to create the key if it doesn't exist.\r\n\r\nPut the key in `GOOGLE_TRANSLATE_API_KEY` environment variable or in the config file.\r\n\r\n```yaml\r\n# config/i18n-tasks.yml\r\ntranslation:\r\n  api_key: <Google Translate API key>\r\n```\r\n\r\n## Interactive console\r\n\r\n`i18n-tasks irb` starts an IRB session in i18n-tasks context. Type `guide` for more information.\r\n\r\n### XLSX\r\n\r\nExport missing and unused data to XLSX:\r\n\r\n```console\r\n$ i18n-tasks xlsx-report\r\n```\r\n\r\n## Add new tasks\r\n\r\nTasks that come with the gem are defined in [lib/i18n/tasks/command/commands](lib/i18n/tasks/command/commands).\r\nCustom tasks can be added easily, see the examples [on the wiki](https://github.com/glebm/i18n-tasks/wiki#custom-tasks).\r\n\r\n[MIT license]: /LICENSE.txt\r\n[travis]: https://travis-ci.org/glebm/i18n-tasks\r\n[badge-travis]: http://img.shields.io/travis/glebm/i18n-tasks.svg\r\n[coverage]: https://codeclimate.com/github/glebm/i18n-tasks\r\n[badge-coverage]: https://img.shields.io/codeclimate/coverage/github/glebm/i18n-tasks.svg\r\n[gemnasium]: https://gemnasium.com/glebm/i18n-tasks\r\n[badge-gemnasium]: https://gemnasium.com/glebm/i18n-tasks.svg\r\n[code-climate]: https://codeclimate.com/github/glebm/i18n-tasks\r\n[badge-code-climate]: http://img.shields.io/codeclimate/github/glebm/i18n-tasks.svg\r\n[config]: https://github.com/glebm/i18n-tasks/blob/master/templates/config/i18n-tasks.yml\r\n[wiki]: https://github.com/glebm/i18n-tasks/wiki \"i18n-tasks wiki\"\r\n[i18n-gem]: https://github.com/svenfuchs/i18n \"svenfuchs/i18n on Github\"\r\n[screenshot-i18n-tasks]: https://i.imgur.com/XZBd8l7.png \"i18n-tasks screenshot\"\r\n[screenshot-find]: https://i.imgur.com/VxBrSfY.png \"i18n-tasks find output screenshot\"\r\n[adapter-example]: https://github.com/glebm/i18n-tasks/blob/master/lib/i18n/tasks/data/file_system_base.rb\r\n[custom-scanner-docs]: https://github.com/glebm/i18n-tasks/wiki/A-custom-scanner-example\r\n","google":"UA-65961090-1","note":"Don't delete this file! It's used internally to help with page regeneration."}